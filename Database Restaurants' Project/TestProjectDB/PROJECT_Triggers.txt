CREATE or REPLACE TRIGGER USER_ADMIN_ALLOC
AFTER INSERT
ON USERS
FOR EACH ROW
DECLARE
BEGIN
INSERT into USERS_ADMIN_ALLOCATION
SELECT :NEW.USER_ID, A.ADMIN_ID
FROM ADMINS A;
end;

CREATE or REPLACE TRIGGER ADMIN_USER_ALLOC
AFTER INSERT
ON ADMINS
FOR EACH ROW
DECLARE
BEGIN
INSERT into USERS_ADMIN_ALLOCATION
SELECT U.USER_ID, :NEW.ADMIN_ID
FROM USERS U;
end;

CREATE or REPLACE TRIGGER AUTHORITY_ADMIN_ALLOC
AFTER INSERT
ON AUTHORITIES
FOR EACH ROW
DECLARE
BEGIN
INSERT into AUTHORITIES_ADMIN_ALLOCATION
SELECT :NEW.AUTH_ID, A.ADMIN_ID
FROM ADMINS A;
end;

CREATE or REPLACE TRIGGER ADMIN_AUTHORITY_ALLOC
AFTER INSERT
ON ADMINS
FOR EACH ROW
DECLARE
BEGIN
INSERT into AUTHORITIES_ADMIN_ALLOCATION
SELECT AU.AUTH_ID, :NEW.ADMIN_ID
FROM AUTHORITIES AU;
end;

CREATE or REPLACE TRIGGER ADMIN_BRANCHES_ALLOC
AFTER INSERT
ON ADMINS
FOR EACH ROW
DECLARE
BEGIN
INSERT into BRANCHES_ADMIN_ALLOCATION
SELECT BR.REST_ID, BR.LOCATION_ID, :NEW.ADMIN_ID
FROM RESTAURANTS_BRANCHES BR;
end;

CREATE or REPLACE TRIGGER BRANCHES_ADMIN_ALLOC
AFTER INSERT
ON RESTAURANTS_BRANCHES
FOR EACH ROW
DECLARE
BEGIN
INSERT into BRANCHES_ADMIN_ALLOCATION
SELECT :NEW.REST_ID, :NEW.LOCATION_ID, A.ADMIN_ID
FROM ADMINS A;
end;

CREATE or REPLACE TRIGGER DELETE_RESTAURANTS
BEFORE DELETE
ON RESTAURANTS
FOR EACH ROW
DECLARE
BEGIN
DELETE FROM BRANCH_MENUS WHERE REST_ID = :OLD.REST_ID;
DELETE FROM BRANCHES_ADMIN_ALLOCATION WHERE REST_ID = :OLD.REST_ID;
DELETE FROM RESTAURANTS_AUTHORITY WHERE REST_ID = :OLD.REST_ID;
DELETE FROM RESTAURANTS_BRANCHES WHERE REST_ID = :OLD.REST_ID;
DELETE FROM USERS_BRANCH_RATING WHERE REST_ID = :OLD.REST_ID;
DELETE FROM USERS_MENU_RATING WHERE REST_ID = :OLD.REST_ID;
end;

CREATE or REPLACE TRIGGER DELETE_LOCATIONS
BEFORE DELETE
ON LOCATIONS
FOR EACH ROW
DECLARE
BEGIN
DELETE FROM BRANCH_MENUS WHERE LOCATION_ID = :OLD.LOCATION_ID;
DELETE FROM BRANCHES_ADMIN_ALLOCATION WHERE LOCATION_ID = :OLD.LOCATION_ID;
DELETE FROM RESTAURANTS_AUTHORITY WHERE LOCATION_ID = :OLD.LOCATION_ID;
DELETE FROM RESTAURANTS_BRANCHES WHERE LOCATION_ID = :OLD.LOCATION_ID;
DELETE FROM USERS_BRANCH_RATING WHERE LOCATION_ID = :OLD.LOCATION_ID;
DELETE FROM USERS_MENU_RATING WHERE LOCATION_ID = :OLD.LOCATION_ID;
end;

CREATE or REPLACE TRIGGER DELETE_ADMINS
BEFORE DELETE
ON ADMINS
FOR EACH ROW
DECLARE
BEGIN
DELETE FROM AUTHORITIES_ADMIN_ALLOCATION WHERE ADMIN_ID = :OLD.ADMIN_ID;
DELETE FROM BRANCHES_ADMIN_ALLOCATION WHERE ADMIN_ID = :OLD.ADMIN_ID;
DELETE FROM USERS_ADMIN_ALLOCATION WHERE ADMIN_ID = :OLD.ADMIN_ID;
end;

CREATE or REPLACE TRIGGER DELETE_AUTHORITIES
BEFORE DELETE
ON AUTHORITIES
FOR EACH ROW
DECLARE
BEGIN
DELETE FROM AUTHORITIES_ADMIN_ALLOCATION WHERE AUTH_ID = :OLD.AUTH_ID;
DELETE FROM RESTAURANTS_AUTHORITY WHERE AUTH_ID = :OLD.AUTH_ID;
end;

CREATE or REPLACE TRIGGER DELETE_USERS
BEFORE DELETE
ON USERS
FOR EACH ROW
DECLARE
BEGIN
DELETE FROM USERS_ADMIN_ALLOCATION WHERE USER_ID = :OLD.USER_ID;
DELETE FROM USERS_BRANCH_RATING WHERE USER_ID = :OLD.USER_ID;
DELETE FROM USERS_MENU_RATING WHERE USER_ID = :OLD.USER_ID;
end;

CREATE or REPLACE TRIGGER DELETE_BRANCH_MENUS
BEFORE DELETE
ON BRANCH_MENUS
FOR EACH ROW
DECLARE
BEGIN
DELETE FROM USERS_MENU_RATING WHERE REST_ID = :OLD.REST_ID AND LOCATION_ID = :OLD.LOCATION_ID AND ITEM_ID = :OLD.ITEM_ID;
end;

CREATE or REPLACE TRIGGER DELETE_MENU_ITEMS
BEFORE DELETE
ON MENU_ITEMS
FOR EACH ROW
DECLARE
BEGIN
DELETE FROM BRANCH_MENUS WHERE ITEM_ID = :OLD.ITEM_ID;
DELETE FROM USERS_MENU_RATING WHERE ITEM_ID = :OLD.ITEM_ID;
end;


CREATE or REPLACE TRIGGER DELETE_RESTAURANTS_BRANCHES
BEFORE DELETE
ON RESTAURANTS_BRANCHES
FOR EACH ROW
DECLARE
BEGIN
DELETE FROM BRANCH_MENUS WHERE REST_ID = :OLD.REST_ID AND LOCATION_ID = :OLD.LOCATION_ID;
DELETE FROM BRANCHES_ADMIN_ALLOCATION WHERE REST_ID = :OLD.REST_ID AND LOCATION_ID = :OLD.LOCATION_ID;
DELETE FROM RESTAURANTS_AUTHORITY WHERE REST_ID = :OLD.REST_ID AND LOCATION_ID = :OLD.LOCATION_ID;
DELETE FROM USERS_BRANCH_RATING WHERE REST_ID = :OLD.REST_ID AND LOCATION_ID = :OLD.LOCATION_ID;
DELETE FROM USERS_MENU_RATING WHERE REST_ID = :OLD.REST_ID AND LOCATION_ID = :OLD.LOCATION_ID;
end;







